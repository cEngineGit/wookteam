webpackJsonp([7],{272:function(t,e,a){var i=a(2)(a(275),a(276),!1,function(t){a(273)},"data-v-5457ca2e",null);t.exports=i.exports},273:function(t,e,a){var i=a(274);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a(1)("75177e9a",i,!0,{})},274:function(t,e,a){(t.exports=a(0)(!1)).push([t.i,".w-content[data-v-5457ca2e]{position:absolute;top:72px;left:0;right:0;bottom:0;overflow:auto;background-repeat:no-repeat;background-position:50%;background-color:#eee;background-size:cover}.w-content .w-container[data-v-5457ca2e]{min-height:500px}",""])},275:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"WContent",data:function(){return{bgid:-1}},mounted:function(){this.bgid=$A.runNum(this.usrInfo.bgid)},watch:{usrInfo:{handler:function(t){this.bgid=$A.runNum(t.bgid)},deep:!0}},methods:{getBgUrl:function(t,e){return t<0?"none":(t=Math.max(1,parseInt(t)),"url("+window.location.origin+"/images/bg/"+(e?"thumb/":"")+t+".jpg)")}}}},276:function(t,e){t.exports={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"w-content",style:"background-image:"+this.getBgUrl(this.bgid)},[this._t("default")],2)},staticRenderFns:[]}},294:function(t,e,a){var i=a(2)(a(297),a(298),!1,function(t){a(295)},null,null);t.exports=i.exports},295:function(t,e,a){var i=a(296);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a(1)("5c628eca",i,!0,{})},296:function(t,e,a){(t.exports=a(0)(!1)).push([t.i,'.tags-wrap{display:inline-block;width:100%;min-height:32px;padding:2px 7px;border:1px solid #dddee1;border-radius:4px;color:#495060;background:#fff;position:relative;cursor:text;vertical-align:middle;line-height:normal;-webkit-transition:border .2s ease-in-out,background .2s ease-in-out,-webkit-box-shadow .2s ease-in-out;transition:border .2s ease-in-out,background .2s ease-in-out,-webkit-box-shadow .2s ease-in-out}.tags-wrap .tags-input,.tags-wrap .tags-item{position:relative;float:left;color:#495060;background-color:#f1f8ff;border-radius:3px;line-height:22px;margin:2px 6px 2px 0;padding:0 20px 0 6px}.tags-wrap .tags-input .tags-content,.tags-wrap .tags-item .tags-content{line-height:22px}.tags-wrap .tags-input .tags-del,.tags-wrap .tags-item .tags-del{width:20px;height:22px;text-align:center;cursor:pointer;position:absolute;top:-1px;right:0}.tags-wrap .tags-input{max-width:80%;padding:0;background-color:inherit;border:none;color:inherit;height:22px;line-height:22px;-webkit-appearance:none;outline:none;resize:none;overflow:hidden}.tags-wrap .tags-input::-webkit-input-placeholder{color:#bbb}.tags-wrap .tags-input::-moz-placeholder{color:#bbb}.tags-wrap .tags-input::-ms-input-placeholder{color:#bbb}.tags-wrap .tags-input::placeholder{color:#bbb}.tags-wrap .tags-placeholder{position:absolute;left:0;top:0;z-index:-1;color:#ffffff00}.tags-wrap:after{content:"";display:block;height:0;clear:both}',""])},297:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"TagInput",props:{value:{default:""},cut:{default:","},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},placeholder:{default:""},max:{default:0}},data:function(){var t=[];return this.value.split(",").forEach(function(e){e&&t.push(e)}),{minWidth:80,tis:"",tisTimeout:null,showPlaceholder:!0,content:"",disSource:t}},mounted:function(){this.wayMinWidth()},watch:{placeholder:function(){this.wayMinWidth()},value:function(t){var e=[];$A.count(t)>0&&t.split(",").forEach(function(t){t&&e.push(t)}),this.disSource=e},disSource:function(t){var e=this,a="";t.forEach(function(t){""!=a&&(a+=e.cut),a+=t}),this.$emit("input",a)}},methods:{wayMinWidth:function(){var t=this;this.showPlaceholder=!0,this.$nextTick(function(){t.$refs.myPlaceholder&&(t.minWidth=Math.max(t.minWidth,t.$refs.myPlaceholder.offsetWidth)),setTimeout(function(){try{t.minWidth=Math.max(t.minWidth,t.$refs.myPlaceholder.offsetWidth),t.showPlaceholder=!1}catch(t){}$A(t.$refs.myPlaceholder).is(":visible")||t.wayMinWidth()},500)})},pasteText:function(t){t.preventDefault();var e=(t.clipboardData||window.clipboardData).getData("text");this.addTag(!1,e)},clickWrap:function(){this.$refs.myTextarea.focus()},downEnter:function(t){t.preventDefault()},addTag:function(t,e){var a=this;if(13===t.keyCode||!1===t)""!=e.trim()&&-1===this.disSource.indexOf(e.trim())&&this.disSource.push(e.trim()),this.content="";else{if(this.max>0&&this.disSource.length>=this.max)return this.content="",this.tis="最多只能添加"+this.max+"个",clearInterval(this.tisTimeout),void(this.tisTimeout=setTimeout(function(){a.tis=""},2e3));var i=e.trim(),s=i.length-this.cut.length;""!=i&&i.substring(s)===this.cut&&(""!=(i=i.substring(0,s)).trim()&&-1===this.disSource.indexOf(i.trim())&&this.disSource.push(i.trim()),this.content="")}},delTag:function(t){if(!1===t){if(""!==this.content)return;t=this.disSource.length-1}this.disSource.splice(t,1)}}}},298:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tags-wrap",on:{paste:function(e){return t.pasteText(e)},click:t.clickWrap}},[t._l(t.disSource,function(e,i){return a("div",{staticClass:"tags-item"},[a("span",{staticClass:"tags-content",on:{click:function(t){t.stopPropagation()}}},[t._v(t._s(e))]),a("span",{staticClass:"tags-del",on:{click:function(e){return e.stopPropagation(),t.delTag(i)}}},[t._v("×")])])}),t._v(" "),a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.content,expression:"content"}],ref:"myTextarea",staticClass:"tags-input",style:{minWidth:t.minWidth+"px"},attrs:{placeholder:t.tis||t.placeholder,disabled:t.disabled,readonly:t.readonly},domProps:{value:t.content},on:{keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.downEnter(e)},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"delete",[8,46],e.key,["Backspace","Delete","Del"])?null:t.delTag(!1)}],keyup:function(e){return t.addTag(e,t.content)},blur:function(e){return t.addTag(!1,t.content)},input:function(e){e.target.composing||(t.content=e.target.value)}}}),t._v(" "),t.showPlaceholder||""!==t.tis?a("span",{ref:"myPlaceholder",staticClass:"tags-placeholder"},[t._v(t._s(t.tis||t.placeholder))]):t._e()],2)},staticRenderFns:[]}},612:function(t,e,a){var i=a(613);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a(1)("79694ec6",i,!0,{})},613:function(t,e,a){(t.exports=a(0)(!1)).push([t.i,".team-add-red-input{display:inline-block;margin-right:4px;line-height:1;font-family:SimSun,serif;font-size:14px;color:#ed4014}.team-add-form-item-changepass{margin-top:-18px;margin-bottom:18px;height:0;overflow:hidden;-webkit-transition:all .2s;transition:all .2s}.team-add-form-item-changepass.show{height:32px}",""])},614:function(t,e,a){var i=a(615);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a(1)("2578fad4",i,!0,{})},615:function(t,e,a){(t.exports=a(0)(!1)).push([t.i,".team .team-main[data-v-f6f3eb94]{padding:15px}.team .team-main .team-body[data-v-f6f3eb94],.team .team-main[data-v-f6f3eb94]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;width:100%;height:100%}.team .team-main .team-body[data-v-f6f3eb94]{min-height:500px;background:#fefefe;border-radius:3px}.team .team-main .team-body .tableFill[data-v-f6f3eb94]{margin:20px;background-color:#fff}",""])},616:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a(272),s=a.n(i),n=a(17),o=a.n(n),r=a(294),l=a.n(r);e.default={components:{TagInput:l.a,ImgUpload:o.a,WContent:s.a},data:function(){return{loadIng:0,isAdmin:!1,columns:[],lists:[],listPage:1,listTotal:0,noDataText:"",addShow:!1,formData:{id:0,userimg:"",profession:"",username:"",nickname:"",userpass:""}}},mounted:function(){this.getLists(!0)},deactivated:function(){this.addShow=!1},watch:{usrName:function(){this.usrLogin&&this.getLists(!0)}},methods:{initLanguage:function(){var t=this;this.isAdmin=$A.identity("admin"),this.noDataText=this.$L("数据加载中....."),this.columns=[{title:this.$L("头像"),minWidth:60,maxWidth:100,render:function(t,e){return t("UserImg",{props:{info:e.row},style:{width:"30px",height:"30px",fontSize:"16px",lineHeight:"30px",borderRadius:"15px",verticalAlign:"middle"}})}},{title:this.$L("用户名"),key:"username",minWidth:80,ellipsis:!0,render:function(e,a){var i=[];return a.row.username==t.usrName&&i.push(e("span",{style:{color:"#ff0000",paddingRight:"4px"}},"[自己]")),$A.identityRaw("admin",a.row.identity)&&i.push(e("span",{style:{color:"#ff0000",paddingRight:"4px"}},"[管理员]")),i.push(e("span",a.row.username)),e("span",i)}},{title:this.$L("昵称"),minWidth:80,ellipsis:!0,render:function(t,e){return t("span",e.row.nickname||"-")}},{title:this.$L("职位/职称"),minWidth:100,ellipsis:!0,render:function(t,e){return t("span",e.row.profession||"-")}},{title:this.$L("加入时间"),width:160,render:function(t,e){return t("span",$A.formatDate("Y-m-d H:i:s",e.row.regdate))}},{title:this.$L("操作"),key:"action",width:this.isAdmin?160:80,align:"center",render:function(e,a){var i=[];return i.push(e("Button",{props:{type:"primary",size:"small"},style:{fontSize:"12px"},on:{click:function(){t.$Modal.info({title:t.$L("会员信息"),content:"<p>"+t.$L("昵称")+": "+(a.row.nickname||"-")+"</p><p>"+t.$L("职位/职称")+": "+(a.row.profession||"-")+"</p>"})}}},t.$L("查看"))),t.isAdmin&&i.push(e("Dropdown",{props:{trigger:"click",transfer:!0},on:{"on-click":function(e){t.handleUser(e,a.row)}}},[e("Button",{props:{type:"warning",size:"small"},style:{fontSize:"12px",marginLeft:"5px"}},t.$L("操作")),e("DropdownMenu",{slot:"list"},[e("DropdownItem",{props:{name:"edit"}},t.$L("修改成员信息")),e("DropdownItem",{props:{name:$A.identityRaw("admin",a.row.identity)?"deladmin":"setadmin"}},t.$L($A.identityRaw("admin",a.row.identity)?"取消管理员":"设为管理员")),e("DropdownItem",{props:{name:"delete"}},t.$L("删除"))])])),e("div",i)}}]},setPage:function(t){this.listPage=t,this.getLists()},setPageSize:function(t){Math.max($A.runNum(this.listPageSize),10)!=t&&(this.listPageSize=t,this.getLists())},getLists:function(t){var e=this;!0===t&&(this.listPage=1),this.loadIng++,this.noDataText=this.$L("数据加载中....."),$A.apiAjax({url:"users/team/lists",data:{page:Math.max(this.listPage,1),pagesize:Math.max($A.runNum(this.listPageSize),10)},complete:function(){e.loadIng--},error:function(){e.noDataText=e.$L("数据加载失败！")},success:function(t){1===t.ret?(e.lists=t.data.lists,e.listTotal=t.data.total,e.noDataText=e.$L("没有相关的数据")):(e.lists=[],e.listTotal=0,e.noDataText=t.msg)}})},onAdd:function(){var t=this;this.loadIng++;var e=$A.runNum(this.formData.id);$A.apiAjax({url:"users/team/add",data:this.formData,complete:function(){t.loadIng--},success:function(a){1===a.ret?(t.addShow=!1,t.$Message.success(a.msg),t.$refs.add.resetFields(),t.getLists(0==e)):t.$Modal.error({title:t.$L("温馨提示"),content:a.msg})}})},handleUser:function(t,e){var a=this;switch(t){case"add":this.addShow=!0,this.formData={id:0,userimg:"",profession:"",username:"",nickname:"",userpass:"",changepass:1};break;case"edit":this.addShow=!0,this.formData=Object.assign($A.cloneData(e));break;case"delete":this.$Modal.confirm({title:this.$L("删除团队成员"),content:this.$L("你确定要删除此团队成员吗？"),loading:!0,onOk:function(){$A.apiAjax({url:"users/team/delete?username="+e.username,error:function(){a.$Modal.remove(),alert(a.$L("网络繁忙，请稍后再试！"))},success:function(t){a.$Modal.remove(),a.getLists(),setTimeout(function(){1===t.ret?a.$Message.success(t.msg):a.$Modal.error({title:a.$L("温馨提示"),content:t.msg})},350)}})}});break;case"setadmin":case"deladmin":this.$Modal.confirm({title:this.$L("确定操作"),content:this.$L("deladmin"==t?"你确定取消管理员身份的操作吗？":"你确定设置管理员的操作吗？"),loading:!0,onOk:function(){$A.apiAjax({url:"users/team/admin?act="+("deladmin"==t?"del":"set")+"&username="+e.username,error:function(){a.$Modal.remove(),alert(a.$L("网络繁忙，请稍后再试！"))},success:function(i){if(a.$Modal.remove(),1===i.ret&&(a.lists.some(function(t){if(t.username==e.username)return a.$set(t,"identity",i.data.identity),!0}),1===i.data.up)){var s={type:"text",username:a.usrInfo.username,userimg:a.usrInfo.userimg,indate:Math.round((new Date).getTime()/1e3),text:a.$L("deladmin"==t?"您的管理员身份已被撤销。":"恭喜您成为管理员。")};$A.WSOB.sendTo("user",e.username,s,"special"),$A.WSOB.sendTo("info",e.username,{type:"update"})}setTimeout(function(){1===i.ret?a.$Message.success(i.msg):a.$Modal.error({title:a.$L("温馨提示"),content:i.msg})},350)}})}})}}}}},617:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"w-main team"},[a("v-title",[t._v(t._s(t.$L("团队"))+"-"+t._s(t.$L("轻量级的团队在线协作")))]),t._v(" "),a("div",{staticClass:"w-nav"},[a("div",{staticClass:"nav-row"},[a("div",{staticClass:"w-nav-left"},[a("div",{staticClass:"page-nav-left"},[a("span",[a("i",{staticClass:"ft icon"},[t._v("")]),t._v(" "+t._s(t.$L("团队成员")))]),t._v(" "),t.loadIng>0?a("div",{staticClass:"page-nav-loading"},[a("w-loading")],1):a("div",{staticClass:"page-nav-refresh"},[a("em",{on:{click:function(e){return t.getLists(!0)}}},[t._v(t._s(t.$L("刷新")))])])])]),t._v(" "),a("div",{staticClass:"w-nav-flex"}),t._v(" "),a("div",{staticClass:"m768-show w-nav-right"},[a("Dropdown",{attrs:{trigger:"click",transfer:""},on:{"on-click":t.handleUser}},[a("Icon",{attrs:{type:"md-menu",size:"18"}}),t._v(" "),a("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[a("DropdownItem",{attrs:{name:"add"}},[t._v(t._s(t.$L("添加团队成员")))])],1)],1)],1),t._v(" "),a("div",{staticClass:"m768-hide w-nav-right"},[a("span",{staticClass:"ft hover",on:{click:function(e){return t.handleUser("add")}}},[a("i",{staticClass:"ft icon"},[t._v("")]),t._v(" "+t._s(t.$L("添加团队成员")))])])])]),t._v(" "),a("w-content",[a("div",{staticClass:"team-main"},[a("div",{staticClass:"team-body"},[a("Table",{ref:"tableRef",staticClass:"tableFill",attrs:{columns:t.columns,data:t.lists,loading:t.loadIng>0,"no-data-text":t.noDataText,stripe:""}}),t._v(" "),a("Page",{staticClass:"pageBox",attrs:{total:t.listTotal,current:t.listPage,disabled:t.loadIng>0,"page-size-opts":[10,20,30,50,100],placement:"top","show-elevator":"","show-sizer":"","show-total":"",simple:t.windowMax768},on:{"on-change":t.setPage,"on-page-size-change":t.setPageSize}})],1)])]),t._v(" "),a("Modal",{attrs:{title:t.$L(t.formData.id>0?"修改团队成员":"添加团队成员"),closable:!1,"mask-closable":!1,"class-name":"simple-modal"},model:{value:t.addShow,callback:function(e){t.addShow=e},expression:"addShow"}},[a("Form",{ref:"add",attrs:{model:t.formData,"label-width":80},nativeOn:{submit:function(t){t.preventDefault()}}},[a("FormItem",{attrs:{prop:"userimg",label:t.$L("头像")}},[a("ImgUpload",{model:{value:t.formData.userimg,callback:function(e){t.$set(t.formData,"userimg",e)},expression:"formData.userimg"}})],1),t._v(" "),a("FormItem",{attrs:{prop:"nickname",label:t.$L("昵称")}},[a("Input",{attrs:{type:"text"},model:{value:t.formData.nickname,callback:function(e){t.$set(t.formData,"nickname",e)},expression:"formData.nickname"}})],1),t._v(" "),a("FormItem",{attrs:{prop:"profession",label:t.$L("职位/职称")}},[a("Input",{model:{value:t.formData.profession,callback:function(e){t.$set(t.formData,"profession",e)},expression:"formData.profession"}})],1),t._v(" "),a("FormItem",{attrs:{prop:"username"}},[a("div",{attrs:{slot:"label"},slot:"label"},[0==t.formData.id?a("em",{staticClass:"team-add-red-input"},[t._v("*")]):t._e(),t._v(t._s(t.$L("用户名")))]),t._v(" "),t.formData.id>0?a("Input",{attrs:{disabled:""},model:{value:t.formData.username,callback:function(e){t.$set(t.formData,"username",e)},expression:"formData.username"}}):a("TagInput",{attrs:{placeholder:t.$L("添加后不可修改，使用英文逗号添加多个。")},model:{value:t.formData.username,callback:function(e){t.$set(t.formData,"username",e)},expression:"formData.username"}})],1),t._v(" "),a("FormItem",{attrs:{prop:"userpass"}},[a("div",{attrs:{slot:"label"},slot:"label"},[0==t.formData.id?a("em",{staticClass:"team-add-red-input"},[t._v("*")]):t._e(),t._v(t._s(t.$L("登录密码")))]),t._v(" "),a("Input",{attrs:{type:"password",placeholder:t.$L(t.formData.id>0?"留空不修改":"最少6位数")},model:{value:t.formData.userpass,callback:function(e){t.$set(t.formData,"userpass",e)},expression:"formData.userpass"}})],1),t._v(" "),0==t.formData.id?a("FormItem",{staticClass:"team-add-form-item-changepass",class:{show:t.formData.userpass},attrs:{prop:"changepass"}},[a("Checkbox",{attrs:{"true-value":1,"false-value":0},model:{value:t.formData.changepass,callback:function(e){t.$set(t.formData,"changepass",e)},expression:"formData.changepass"}},[t._v(t._s(t.$L("首次登陆需修改密码")))])],1):t._e()],1),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"default"},on:{click:function(e){t.addShow=!1}}},[t._v(t._s(t.$L("取消")))]),t._v(" "),a("Button",{attrs:{type:"primary",loading:t.loadIng>0},on:{click:t.onAdd}},[t._v(t._s(t.$L(t.formData.id>0?"修改":"添加")))])],1)],1)],1)},staticRenderFns:[]}},649:function(t,e,a){var i=a(2)(a(616),a(617),!1,function(t){a(612),a(614)},"data-v-f6f3eb94",null);t.exports=i.exports}});